---
title: "STA3100 Final Project Report"
author: "Anjali Tomerlin and Elena Pedeton"
bibliography: final_project_ref.bib
link-citations: yes
csl: ieee.csl
output: 
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    theme: cosmo
    css: style.css
date: "2025-11-03"
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(gridExtra)
library(segmented)
library(gt)
library(grid)
```



# Abstract

# Introduction

## Background Information

---

Immediately following the advent of the COVID-19 pandemic in 2020, the focus of much academic research and funding pivoted towards the medicine and public health sectors. However, the long-term impact of this shift on the prevalence of research in other areas, particularly the humanities, has been overlooked. Our study is motivated by the lack of available information and analysis on this topic, despite it being one of great importance. Research in the humanities, though often disregarded by those in STEM-related fields, is necessary as it fosters critical thinking, empathy, and a greater understanding of human society and culture.  

A 2021 study investigated the effect the COVID-19 pandemic had on the production medicine research and found an estimated 18% decrease in non-COVID-19 related published works @biomedcentralImpactCOVID19. However, no prior studies have conducted a comprehensive review of the pandemic's effect on the production of research in the humanities.

## Objectives

---

Five years after the initial COVID-19 outbreak, we aim to investigate and compare the trends in the number of published works on medicine and humanities-related fields---specifically history, philosophy, art, and literature---before and after the pandemic. We also aim to compare more generally the number of published works in the humanities with those in medicine. Our analysis will highlight any potential difference in research productivity between fields or patterns of decline in research pre and post-pandemic. By doing so, we hope to call attention to the importance of the humanities and, more broadly, research in academia.


# Data & Preliminary Analysis

---

The data sets used in our project are sourced from OpenAlex, an open-source catalog of scholarly works. OpenAlex categorizes works using a hierarchical structure known as *concepts*. There are 19 root-level concepts, which represent broad categories of research such as Engineering and History, and 6 branching layers of concepts, each increasing in topic specificity @openalexConceptsOpenAlex. 

We utilize OpenAlex's data sets for the number of published works whose concept classifiers are history @openalexOpenAlexhistory, philosophy @openalexOpenAlexphilo, art @openalexOpenAlexart, literature @openalexOpenAlexlit, and medicine @openalexOpenAlexmedicine. All of these fall into level 0 of the concept hierarchy, the most broad category, except for literature, which is slightly more specific at level 1. Although each of these OpenAlex data sets have values dating back to 1826, our analysis only considers those from years 2000 to 2024 for relevancy. 

## Trend Evaluation

---

```{r Scatterplot all Fields/Years,fig.align='center'}
history <- read_csv("./history_counts.csv",show_col_types = FALSE) |> mutate(topic=c("History"))
philo <- read_csv("./philosophy_counts.csv",show_col_types = FALSE) |> mutate(topic=c("Philosophy"))
art <- read_csv("./art_counts.csv",show_col_types = FALSE) |> mutate(topic=c("Art"))
lit <- read_csv("./literature_counts.csv",show_col_types = FALSE) |> mutate(topic=c("Literature"))
medicine <- read_csv("./medicine_counts.csv",show_col_types = FALSE) |> mutate(topic=c("Medicine"))
all_topics <- bind_rows(history,philo,art,lit,medicine) |> filter(name <=2024, name >= 2000)
ggplot(all_topics,aes(x=name,y=count,color=topic)) + geom_point() + labs(title="Number of Published Works by Field on OpenAlex (2000-2024)",x="Year",y="Number of Published Works",color="Field")
```

---

It is clear from the scatterplot above that all four humanities-related fields---history, philosophy, art, and literature---display an increasing trend in number of published works from 2000 to 2020 and a decreasing trend thereafter. 

---

```{r Literature Pre/Post 2020 Plots,fig.align='center'}
lit <- read_csv("./literature_counts.csv",show_col_types = FALSE)
pre2020 <- ggplot(filter(lit,name<2020,name>=2000),aes(x=name,y=count)) + geom_point() + labs(title="Number of Literature-Related Published Works on OpenAlex (2000-2019)",x="Year",y="Number of Published Works")
post2020 <- ggplot(filter(lit,name>=2020,name<=2024),aes(x=name,y=count)) + geom_point() + labs(title="Number of Literature-Related Published Works on OpenAlex (2020-2024)",x="Year",y="Number of Published Works")
grid.arrange(pre2020,post2020)
```

---

However, medicine is distinct as it displays a clear upward trend in the number of published works from 2000 to 2020 but does not exhibit an immediately apparent pattern thereafter. Additionally, the number of medicine-related works spikes in 2020, presumably in response to the emerging pandemic. 

---

```{r Medicine Pre/Post 2020 Plots,fig.align='center'}
medicine <- read_csv("./medicine_counts.csv",show_col_types = FALSE)
pre2020 <- ggplot(filter(medicine,name<2020,name>=2000),aes(x=name,y=count)) + geom_point() + labs(title="Number of Medicine-Related Published Works on OpenAlex (2000-2019)",x="Year",y="Number of Published Works")
post2020 <- ggplot(filter(medicine,name>=2020,name<=2024),aes(x=name,y=count)) + geom_point() + labs(title="Number of Medicine-Related Published Works on OpenAlex (2020-2024)",x="Year",y="Number of Published Works")
grid.arrange(pre2020,post2020)
```

These trends suggest a decline in emphasis on funding and publishing humanities-related research following the pandemic in 2020 whereas the field of medicine experienced little such effect, remaining relatively stable. However, further analysis is required to establish this (See [Analysis and Results](#analysis-and-results)).

## Comparing Fields

---
```{r}
history <- read_csv("./history_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
philo <- read_csv("./philosophy_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
art <- read_csv("./art_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
lit <- read_csv("./literature_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
medicine <- read_csv("./medicine_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)

hum_2024 <- round(mean(c(history$count,philo$count,art$count,lit$count)))
med_2024 <- round(mean(medicine$count))
diff_2024 <- format(med_2024-hum_2024,scientific=FALSE)
hum_2024 <- format(hum_2024,scientific=FALSE)
med_2024 <- format(med_2024,scientific=FALSE)

history <- read_csv("./history_counts.csv",show_col_types = FALSE) |> filter(name<=2019,name>=2000)
philo <- read_csv("./philosophy_counts.csv",show_col_types = FALSE) |> filter(name<=2019,name>=2000)
art <- read_csv("./art_counts.csv",show_col_types = FALSE) |> filter(name<=2019,name>=2000)
lit <- read_csv("./literature_counts.csv",show_col_types = FALSE) |> filter(name<=2019,name>=2000)
medicine <- read_csv("./medicine_counts.csv",show_col_types = FALSE) |> filter(name<=2019,name>=2000)

hum_2019 <- round(mean(c(history$count,philo$count,art$count,lit$count)))
med_2019 <- round(mean(medicine$count))
diff_2019 <- format(med_2019-hum_2019,scientific=FALSE)
```

The average number of medicine-related published works from 2000 to 2024 exceeds the average for the four humanities-related fields by `r diff_2024`. This is true even for years prior to 2020, a difference of `r diff_2019`, indicating that medicine was a consistently more productive topic of research the humanities even prior to the pandemic. 

Additionally, the average number published works from 2000 to 2024 varies much more between medicine the humanities than between the humanities fields themselves. 

---

```{r Mean Difference Plot,fig.align='center'}
history <- read_csv("./history_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
philo <- read_csv("./philosophy_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
art <- read_csv("./art_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
lit <- read_csv("./literature_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
medicine <- read_csv("./medicine_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)

mean_df <- data.frame(group = as.factor(c("History","Philosophy","Art","Literature","Medicine")),m=c(mean(history$count),mean(philo$count),mean(art$count),mean(lit$count),mean(medicine$count)))

diff_matrix <- outer(mean_df$m,mean_df$m,"-")
rownames(diff_matrix) <- mean_df$group
colnames(diff_matrix) <- mean_df$group

diff_table <- as.data.frame(as.table(diff_matrix))
colnames(diff_table) <- c("field1","field2","diff")

diff_table <- mutate(diff_table,i=match(field1,mean_df$group),j=match(field2,mean_df$group)) |> filter(i>j)

ggplot(diff_table,aes(x=field1,y=field2,fill=diff)) + geom_tile(color="white") + geom_text(aes(label=round(diff)),color="black",size=4) + scale_fill_gradient(low="lightblue",high="mediumpurple",name="Mean Difference") + labs(x=NULL,y=NULL,title="Pairwise Mean Differences in Number of Published Works from 2000 to 2024")
```

---

The variation in number of published works from 2000 to 2024 is much higher for medicine than the humanities-related fields, reflecting its steeper upward trend in publication output over time. 

---

```{r SD Table,fig.align='center'}
history <- read_csv("./history_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
philo <- read_csv("./philosophy_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
art <- read_csv("./art_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
lit <- read_csv("./literature_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)
medicine <- read_csv("./medicine_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000)

sd_df <- data.frame(field = as.factor(c("History","Philosophy","Art","Literature","Medicine")),s=c(sd(history$count),sd(philo$count),sd(art$count),sd(lit$count),sd(medicine$count))) |> mutate(s=round(s)) |> arrange(s)

gt(sd_df) |> cols_label(field="Field",s="Standard Deviation") |> tab_style(style = cell_text(weight = "bold"), locations=cells_column_labels())
```
    
---  

```{r Boxplots,fig.align='center'}
history <- read_csv("./history_counts.csv",show_col_types = FALSE) |> mutate(topic=c("History"))
philo <- read_csv("./philosophy_counts.csv",show_col_types = FALSE) |> mutate(topic=c("Philosophy"))
art <- read_csv("./art_counts.csv",show_col_types = FALSE) |> mutate(topic=c("Art"))
lit <- read_csv("./literature_counts.csv",show_col_types = FALSE) |> mutate(topic=c("Literature"))
medicine <- read_csv("./medicine_counts.csv",show_col_types = FALSE) |> mutate(topic=c("Medicine"))
all_topics <- bind_rows(history,philo,art,lit,medicine) |> filter(name <=2024, name >= 2000)

ggplot(all_topics,aes(x=topic,y=count)) + geom_boxplot() + labs(title="Number of Published Works from 2000 to 2024 Across Fields",y="Number of Published Works",x=NULL)
```

# Analysis and Results

---

Our primary analysis will consist of two procedures:

1. Conduct an interrupted time-series (ITS) analysis on the number of published works before and after the onset of the COVID-19 pandemic in 2020 for each of the five research fields---history, philosophy, art, literature, and medicine---using a piecewise linear regression model.

2. Perform Chow's Test to evaluate whether the presumed structural break period---the COVID-19 pandemic---corresponds to a statistically significant shift in the parameters of the previously constructed piecewise regression model. 

## ITS Analysis

---

The data for each of the five research fields will be split into two categories, data prior to the COVID-19 pandemic (years 2000 to 2019) and after the beginning of the pandemic (years 2020 to 2024). Five segmented linear regression models will be constructed each with a singular breakpoint at the year 2020. This will result in five separate piecewise linear regression functions for each field with the independent variable $\small t$, measured in years since 2000, and dependent variable $\small \hat{y}(t)$, the estimated number of works published in that field at time $\small t$. 

The segmented linear regression model constructs a linear regression using the method of ordinary least squares for points before and after a number of specified breakpoints while ensuring continuity between regression segments at the breakpoint. This that the two separate linear regression functions which are constructed for $\small t\leq20$ and $\small t>20$ meet at $\small t=20$ exactly. A segmented linear regression model for the number of of published works $\small Y_i$ at a time $\small t_i$, measured in years since 2000 is formulated as follows:

---

$$Y_i=\beta_0+\beta_1t_i+\beta_2(t_i-20)^++\epsilon_i$$

<br>

- $\small \beta_0$: Regression intercept for first linear segment ($\small t_i\leq20$)

- $\small \beta_1$: Regression slope for first linear segment ($\small t_i\leq20$)

- $\small \beta_2$: *Change* in regression slope for second linear segment compared to the first

- $\small (t_i-20)^+$: Piecewise function where $\small (t_i-20)^+=t_i-20$ if $\small t_i>20$ and $\small (t_i-20)^+=0$ if $\small t_i\leq20$

- $\small \epsilon_i$: Error term

---

Alternatively, the model can be formulated as the following piecewise function:

<br>

$$Y_i=\begin{cases} \beta_0+\beta_1t_i+\epsilon_i &\text{if } t \leq 20 \\ (\beta_0-20\beta_2)+(\beta_1+\beta_2)t_i+\epsilon_i &\text{if } t > 20 \end{cases}$$
<br>

We will utilize this formulation going forward. From this model, the following regression with estimated coefficients can be calculated for each fields:

---

$$\hat{y}(t)=\begin{cases} a_1 + b_1t& \text{if } t \leq 20 \\ a_2 + b_2t & \text{if } t > 20
\end{cases}$$

<br>

- $\small a_1=\hat{\beta_0}$

- $\small b_1=\hat{\beta_1}$

- $\small a_2=\hat{\beta_0}-20\hat{\beta_2}$

- $\small b_2=\hat{\beta_1}+\hat{\beta_2}$

---

The following table provides the regression parameter estimates for each of the five constructed segmented linear regression models:

```{r Segmented Regression History Plot, fig.height=4,fig.align='center'}
history <- read_csv("./history_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000) |> mutate(name=name-2000)

init_ols_hist <- lm(count ~ name,data=history) 
segmented_ols_hist <- segmented(init_ols_hist,seg.Z= ~name,psi=list(name=20),control = seg.control(it.max = 0))
history$pred <- predict(segmented_ols_hist)
hist_plot <- ggplot(history,aes(x=name,y=count)) + geom_point() + geom_line(aes(y=pred)) + labs(title="History",x=NULL,y=NULL)+ theme(plot.title = element_text(hjust = 0.5))
```

```{r Segmented Regression History Eq}
hist_intercept_1 <- format(round(coefficients(segmented_ols_hist)[[1]]),scientific=FALSE)
hist_coef_1 <- format(round(coefficients(segmented_ols_hist)[[2]]), scientific=FALSE)
hist_coef_2 <- format(round(coefficients(segmented_ols_hist)[[3]]+coefficients(segmented_ols_hist)[[2]]),scientific=FALSE)
hist_intercept_2 <- round(coefficients(segmented_ols_hist)[[1]]-coefficients(segmented_ols_hist)[[3]]*20)
hist_intercept_2 <- format(hist_intercept_2,scientific=FALSE)
```

```{r Segmented Regression Philosophy Plot, fig.height=4,fig.align='center'}
philo <- read_csv("./philosophy_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000) |> mutate(name=name-2000)

init_ols_philo <- lm(count ~ name,data=philo)
segmented_ols_philo <- segmented(init_ols_philo,seg.Z= ~name,psi=list(name=20),control = seg.control(it.max = 0))
philo$pred <- predict(segmented_ols_philo)
philo_plot <- ggplot(philo,aes(x=name,y=count)) + geom_point() + geom_line(aes(y=pred)) + labs(title="Philosophy",x=NULL,y=NULL) + theme(plot.title = element_text(hjust = 0.5))
```

```{r Segmented Regression Philo Eq}
philo_intercept_1 <- format(round(coefficients(segmented_ols_philo)[[1]]),scientific=FALSE)
philo_coef_1 <- format(round(coefficients(segmented_ols_philo)[[2]]), scientific=FALSE)
philo_coef_2 <- format(round(coefficients(segmented_ols_philo)[[3]]+coefficients(segmented_ols_philo)[[2]]),scientific=FALSE)
philo_intercept_2 <- round(coefficients(segmented_ols_philo)[[1]]-coefficients(segmented_ols_philo)[[3]]*20)
philo_intercept_2 <- format(philo_intercept_2,scientific=FALSE)
```

```{r Segmented Regression Art Plot, fig.height=4,fig.align='center'}
art <- read_csv("./art_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000) |> mutate(name=name-2000)

init_ols_art <- lm(count ~ name,data=art)
segmented_ols_art <- segmented(init_ols_art,seg.Z= ~name,psi=list(name=20),control = seg.control(it.max = 0))
art$pred <- predict(segmented_ols_art)
art_plot <- ggplot(art,aes(x=name,y=count)) + geom_point() + geom_line(aes(y=pred)) + labs(title="Art",x=NULL,y=NULL) + theme(plot.title = element_text(hjust = 0.5))
```

```{r Segmented Regression Art Eq}
art_intercept_1 <- format(round(coefficients(segmented_ols_art)[[1]]),scientific=FALSE)
art_coef_1 <- format(round(coefficients(segmented_ols_art)[[2]]), scientific=FALSE)
art_coef_2 <- format(round(coefficients(segmented_ols_art)[[3]]+coefficients(segmented_ols_art)[[2]]),scientific=FALSE)
art_intercept_2 <- round(coefficients(segmented_ols_art)[[1]]-coefficients(segmented_ols_art)[[3]]*20)
art_intercept_2 <- format(art_intercept_2,scientific=FALSE)
```

```{r Segmented Regression Literature Plot, fig.height=4,fig.align='center'}
lit <- read_csv("./literature_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000) |> mutate(name=name-2000)

init_ols_lit <- lm(count ~ name,data=lit)
segmented_ols_lit <- segmented(init_ols_lit,seg.Z= ~name,psi=list(name=20),control = seg.control(it.max = 0))
lit$pred <- predict(segmented_ols_lit)
lit_plot <- ggplot(lit,aes(x=name,y=count)) + geom_point() + geom_line(aes(y=pred)) + labs(title="Literature",x=NULL,y=NULL) + theme(plot.title = element_text(hjust = 0.5))
```

```{r Segmented Regression Lit Eq}
lit_intercept_1 <- format(round(coefficients(segmented_ols_lit)[[1]]),scientific=FALSE)
lit_coef_1 <- format(round(coefficients(segmented_ols_lit)[[2]]), scientific=FALSE)
lit_coef_2 <- format(round(coefficients(segmented_ols_lit)[[3]]+coefficients(segmented_ols_lit)[[2]]),scientific=FALSE)
lit_intercept_2 <- round(coefficients(segmented_ols_lit)[[1]]-coefficients(segmented_ols_lit)[[3]]*20)
lit_intercept_2 <- format(lit_intercept_2,scientific=FALSE)
```

```{r Segmented Regression Medicine Plot, fig.height=4,fig.align='center'}
medicine <- read_csv("./medicine_counts.csv",show_col_types = FALSE) |> filter(name<=2024,name>=2000) |> mutate(name=name-2000)

init_ols_med <- lm(count ~ name,data=medicine)
segmented_ols_med <- segmented(init_ols_med,seg.Z= ~name,psi=list(name=20),control = seg.control(it.max = 0))
medicine$pred <- predict(segmented_ols_med)
med_plot <- ggplot(medicine,aes(x=name,y=count)) + geom_point() + geom_line(aes(y=pred)) + labs(title="Segmented Regression for Number of Medicine-Related Works Versus Year",x="Years Since 2000",y="Number of Published Works")
```

```{r Segmented Regression Med Eq}
med_intercept_1 <- format(round(coefficients(segmented_ols_med)[[1]]),scientific=FALSE)
med_coef_1 <- format(round(coefficients(segmented_ols_med)[[2]]), scientific=FALSE)
med_coef_2 <- format(round(coefficients(segmented_ols_med)[[3]]+coefficients(segmented_ols_med)[[2]]),scientific=FALSE)
med_intercept_2 <- round(coefficients(segmented_ols_med)[[1]]-coefficients(segmented_ols_med)[[3]]*20)
med_intercept_2 <- format(med_intercept_2,scientific=FALSE)
```
<br>

```{r Regression Table}
reg_table <- data.frame(a1=c(hist_intercept_1,philo_intercept_1,art_intercept_1,lit_intercept_1),b1=c(hist_coef_1,philo_coef_1,art_coef_1,lit_coef_1),a2=c(hist_intercept_2,philo_intercept_2,art_intercept_2,lit_intercept_2),b2=c(hist_coef_2,philo_coef_2,art_coef_2,lit_coef_2),names=c("History","Philosophy","Art","Literature"))

gt(reg_table,rowname_col="names")|> cols_label(a1=html("a<sub>1</sub>"),b1=html("b<sub>1</sub>"),a2=html("a<sub>2</sub>"),b2=html("b<sub>2</sub>")) |> tab_style(style = cell_text(weight = "bold"), locations=cells_column_labels())

```

---

```{r Regression Plots}
grid.arrange(hist_plot,philo_plot,art_plot,lit_plot,top=textGrob("Number of Humanities-Related Published Works Versus Years Since 2000",gp=gpar(fontsize = 15)),padding = unit(1, "lines"))
```


Report on r^2 values for these regressions in a table 

## Chow's Test 


# Conclusion

# Contribution Statement

# Works Cited



